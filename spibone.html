
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>SPIBONE &#8212; Fomu Bootloader  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/default.js"></script>
    <script type="text/javascript" src="_static/WaveDrom.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CTRL" href="ctrl.html" />
    <link rel="prev" title="Interrupt Controller" href="interrupts.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="spibone">
<h1>SPIBONE<a class="headerlink" href="#spibone" title="Permalink to this headline">¶</a></h1>
<div class="section" id="wishbone-bridge-over-spi">
<h2>Wishbone Bridge over SPI<a class="headerlink" href="#wishbone-bridge-over-spi" title="Permalink to this headline">¶</a></h2>
<p>This module allows for accessing a Wishbone bridge over a 4-wire protocol.
All operations occur on byte boundaries, and are big-endian.</p>
<p>The device can take a variable amount of time to respond, so the host should
continue polling after the operation begins.  If the Wishbone bus is
particularly busy, such as during periods of heavy processing when the
CPU’s icache is empty, responses can take many thousands of cycles.</p>
<p>The bridge core is designed to run at 1/4 the system clock.</p>
</div>
<div class="section" id="wire-spi-protocol">
<h2>4-Wire SPI Protocol<a class="headerlink" href="#wire-spi-protocol" title="Permalink to this headline">¶</a></h2>
<p>The 4-wire SPI protocol does not require any pins to change direction, and
is therefore suitable for designs with level-shifters or without GPIOs that
can change direction.</p>
<p>While waiting for the response, the <code class="docutils literal notranslate"><span class="pre">MISO</span></code> line remains high.  As soon as
a response is available, the device pulls the <cite>MISO</cite> line low and clocks
out either a <code class="docutils literal notranslate"><span class="pre">0x00</span></code> or <cite>0x01</cite> byte indicating whether it’s a READ or a WRITE
that is being answered.  Note that if the operation is fast enough, the
device will not pull the <cite>MISO</cite> line high and will immediately respond
with <code class="docutils literal notranslate"><span class="pre">0x00</span></code> or <code class="docutils literal notranslate"><span class="pre">0x01</span></code>.</p>
<p>You can abort the operation by driving <code class="docutils literal notranslate"><span class="pre">CS</span></code> high.  However, if a WRITE or
READ has already been initiated then it will not be aborted.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{ "signal": [
    ["Read",
        {  "name": 'MOSI',        "wave": 'x23...x|xxxxxx', "data": '0x01 [ADDRESS]'},
        {  "name": 'MISO',        "wave": 'x.....x|25...x', "data": '0x01 [DATA]'   },
        {  "name": 'CS',          "wave": 'x0.....|.....x', "data": '1 2 3'},
        {  "name": 'data bits',   "wave": 'xx2222x|x2222x', "data": '31:24 23:16 15:8 7:0 31:24 23:16 15:8 7:0'}
    ],
    {},
    ["Write",
        {  "name": 'MOSI',        "wave": 'x23...3...x|xx', "data": '0x00 [ADDRESS] [DATA]'},
        {  "name": 'MISO',        "wave": 'x.........1|2x', "data": '0x00'   },
        {  "name": 'CS',          "wave": 'x0.........|.x', "data": '1 2 3'},
        {  "name": 'data bits',   "wave": 'xx22222222x|xx', "data": '31:24 23:16 15:8 7:0 31:24 23:16 15:8 7:0'}
    ]
]}
</script>
</div>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Fomu Bootloader</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interrupts.html">Interrupt Controller</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SPIBONE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wishbone-bridge-over-spi">Wishbone Bridge over SPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wire-spi-protocol">4-Wire SPI Protocol</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ctrl.html">CTRL</a></li>
<li class="toctree-l1"><a class="reference internal" href="lxspi.html">LXSPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="messible.html">MESSIBLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="reboot.html">REBOOT</a></li>
<li class="toctree-l1"><a class="reference internal" href="rgb.html">RGB</a></li>
<li class="toctree-l1"><a class="reference internal" href="timer0.html">TIMER0</a></li>
<li class="toctree-l1"><a class="reference internal" href="touch.html">TOUCH</a></li>
<li class="toctree-l1"><a class="reference internal" href="usb.html">USB</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">VERSION</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="interrupts.html" title="previous chapter">Interrupt Controller</a></li>
      <li>Next: <a href="ctrl.html" title="next chapter">CTRL</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Sean Cross.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/spibone.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>